# BookScan - Project Architecture

## ğŸ“ Project Structure

```
bookScan/
â”‚
â”œâ”€â”€ ğŸ“„ index.html              # Main HTML entry point
â”œâ”€â”€ ğŸ¨ styles.css              # Mobile-first CSS styling
â”‚
â”œâ”€â”€ ğŸ“¦ Package Files
â”‚   â”œâ”€â”€ package.json           # Dependencies & scripts
â”‚   â”œâ”€â”€ tsconfig.json          # TypeScript configuration
â”‚   â””â”€â”€ .gitignore             # Git ignore rules
â”‚
â”œâ”€â”€ ğŸ“š Documentation
â”‚   â”œâ”€â”€ README.md              # Full project documentation
â”‚   â”œâ”€â”€ QUICKSTART.md          # Quick start guide
â”‚   â””â”€â”€ TODO.md                # Remaining tasks & enhancements
â”‚
â”œâ”€â”€ ğŸ’» Source Code (src/)
â”‚   â”œâ”€â”€ app.ts                 # Main application logic & UI coordination
â”‚   â”œâ”€â”€ types.ts               # TypeScript interfaces (Book, Collection)
â”‚   â”œâ”€â”€ storage.ts             # localStorage management service
â”‚   â”œâ”€â”€ scanner.ts             # Barcode scanning service (Html5Qrcode)
â”‚   â”œâ”€â”€ booksAPI.ts            # Google Books API integration
â”‚   â””â”€â”€ utils.ts               # UI utilities (toasts, modals, loading)
â”‚
â””â”€â”€ ğŸ”¨ Build Output (dist/)
    â””â”€â”€ [Compiled .js files]   # Generated by TypeScript compiler
```

## ğŸ—ï¸ Architecture Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     USER INTERFACE                       â”‚
â”‚                      (index.html)                        â”‚
â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Collections  â”‚  â”‚  Collection  â”‚  â”‚   Scanner    â”‚ â”‚
â”‚  â”‚     View     â”‚  â”‚  Detail View â”‚  â”‚     View     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   APPLICATION LAYER                      â”‚
â”‚                       (app.ts)                           â”‚
â”‚                                                          â”‚
â”‚  â€¢ Event handling & user interactions                   â”‚
â”‚  â€¢ View switching & navigation                          â”‚
â”‚  â€¢ Coordinating services                                â”‚
â”‚  â€¢ UI state management                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â–¼               â–¼               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  StorageService  â”‚ â”‚ ScannerSvc  â”‚ â”‚ BooksAPIServiceâ”‚
â”‚   (storage.ts)   â”‚ â”‚(scanner.ts) â”‚ â”‚ (booksAPI.ts)  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ CRUD           â”‚ â”‚ â€¢ Camera    â”‚ â”‚ â€¢ Fetch by ISBNâ”‚
â”‚   operations     â”‚ â”‚   access    â”‚ â”‚ â€¢ Search books â”‚
â”‚ â€¢ Collections    â”‚ â”‚ â€¢ Barcode   â”‚ â”‚ â€¢ Parse API    â”‚
â”‚ â€¢ Books          â”‚ â”‚   scanning  â”‚ â”‚   responses    â”‚
â”‚ â€¢ localStorage   â”‚ â”‚ â€¢ ISBN      â”‚ â”‚                â”‚
â”‚   persistence    â”‚ â”‚   validationâ”‚ â”‚                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                   â”‚                  â”‚
        â–¼                   â–¼                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   localStorage   â”‚ â”‚Html5Qrcode  â”‚ â”‚ Google Books   â”‚
â”‚   (Browser API)  â”‚ â”‚  Library    â”‚ â”‚      API       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ Data Flow

### Adding a Book via Scan

```
1. User clicks "Scan Book"
         â”‚
         â–¼
2. ScannerService.startScanner()
         â”‚
         â–¼
3. Camera opens, user points at barcode
         â”‚
         â–¼
4. Html5Qrcode detects ISBN
         â”‚
         â–¼
5. BooksAPIService.fetchBookByISBN(isbn)
         â”‚
         â–¼
6. Google Books API returns book data
         â”‚
         â–¼
7. StorageService.addBookToCollection()
         â”‚
         â–¼
8. Data saved to localStorage
         â”‚
         â–¼
9. UI refreshed with new book
```

### Loading Collections

```
1. App initializes
         â”‚
         â–¼
2. StorageService.loadCollections()
         â”‚
         â–¼
3. Data retrieved from localStorage
         â”‚
         â–¼
4. Collections rendered in UI
         â”‚
         â–¼
5. User clicks collection
         â”‚
         â–¼
6. Books displayed for that collection
```

## ğŸ¨ Component Breakdown

### Main Views (index.html)

1. **Collections View** - Grid of collection cards
2. **Collection Detail View** - List of books in a collection
3. **Scanner View** - Camera feed for barcode scanning

### Modals

1. **New Collection Modal** - Input for collection name
2. **Add Book Modal** - Manual book entry form
3. **Collection Menu Modal** - Rename/Delete options

### Shared Components

- **Toast Notifications** - Temporary feedback messages
- **Loading Overlay** - Spinner for async operations
- **App Header** - Title and settings button

## ğŸ”Œ Service APIs

### StorageService

```typescript
loadCollections(): Collection[]
saveCollections(collections: Collection[]): void
createCollection(name: string): Collection
updateCollection(id: string, updates: Partial<Collection>): void
deleteCollection(id: string): void
getCollection(id: string): Collection | null
addBookToCollection(collectionId: string, book: Omit<Book, 'id' | 'addedDate'>): Book
removeBookFromCollection(collectionId: string, bookId: string): void
```

### BooksAPIService

```typescript
fetchBookByISBN(isbn: string): Promise<Book | null>
searchBooks(query: string): Promise<Book[]>
```

### ScannerService

```typescript
startScanner(elementId: string, onSuccess: callback, onError?: callback): Promise<void>
stopScanner(): Promise<void>
isRunning(): boolean
```

### UIUtils

```typescript
showToast(message: string, duration?: number): void
showLoading(message?: string): void
hideLoading(): void
showModal(modalId: string): void
hideModal(modalId: string): void
switchView(viewId: string): void
formatDate(dateString: string): string
escapeHtml(text: string): string
```

## ğŸ“Š Data Models

### Collection

```typescript
{
    id: string              // Unique identifier
    name: string            // Collection name
    books: Book[]           // Array of books
    createdDate: string     // ISO 8601 date
    modifiedDate: string    // ISO 8601 date
}
```

### Book

```typescript
{
    id: string              // Unique identifier
    isbn?: string           // ISBN-10 or ISBN-13
    title: string           // Book title
    authors?: string[]      // Array of author names
    publisher?: string      // Publisher name
    publishedDate?: string  // Publication date
    description?: string    // Book description
    thumbnail?: string      // Cover image URL
    addedDate: string       // ISO 8601 date
}
```

## ğŸ¯ Design Principles

### Mobile-First
- Touch-friendly targets (48px minimum)
- Responsive grid layouts
- Large, clear buttons
- Optimized for one-handed use

### Progressive Enhancement
- Works without JavaScript (basic HTML)
- Graceful degradation for older browsers
- Fallback to manual entry if scanning fails

### Performance
- Minimal dependencies
- Local-first data storage
- Lazy loading of book images
- Efficient DOM updates

### Accessibility
- Semantic HTML
- ARIA labels for icons
- Keyboard navigation support
- High contrast ratios

## ğŸ” Security Considerations

- XSS Prevention via `UIUtils.escapeHtml()`
- No sensitive data stored
- HTTPS required for camera access
- No backend = no server-side vulnerabilities

## ğŸš€ Build Process

```
Source TypeScript (.ts)
        â”‚
        â–¼
TypeScript Compiler (tsc)
        â”‚
        â–¼
JavaScript (.js) + Source Maps (.js.map)
        â”‚
        â–¼
Type Declarations (.d.ts)
        â”‚
        â–¼
Output to dist/ folder
        â”‚
        â–¼
index.html loads from dist/
```

## ğŸ“ˆ Future Architecture Considerations

When implementing planned features:

- **Export/Import**: Add `ExportService` for JSON/CSV handling
- **Search**: Add `SearchService` with indexing
- **PWA**: Add `ServiceWorker` and manifest.json
- **Sync**: Consider `SyncService` for cloud backup
- **Analytics**: Optional `AnalyticsService` wrapper
- **Testing**: Jest for unit tests, Playwright for E2E

---

**This architecture prioritizes simplicity, maintainability, and mobile performance while remaining extensible for future enhancements.**
